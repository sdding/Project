# 머신러닝을 활용한 심박수 예측 프로젝트

* 심박수(HR)와 호흡수(BR)를 비접촉 레이더 데이터를 활용하여, 접촉(ECG) 데이터와 비교학습하여, 레이더 데이터만 가지고 심박수와 호흡수를 정확하게 예측하는 프로젝트
* **기업 요구사항**  
  * Target인 ecg 예측 모델링  
  * 주어진 Radar 데이터에서 정확한 ecg를 예측하기 위한 개인별, FFT크기별 데이터 분석 (DA)  
  * 데이터를 활용한 ML/DL 모델 파이프라인 구축 프로젝트
  * ensemble/svm 를 활용한 정확도 90% 이상
  * 주어진 평가지표  
    * MSE
    * MAE
  
    * ![Untitled](https://user-images.githubusercontent.com/86766081/163770911-03c3b82d-f92e-4d20-8a6d-e073986db5fe.png)
    
      에러율 = |실제값 - 측정값| / 실제값 x 100  
   
## 1. 데이터

   * 기업에서 제공한 11명의 비접촉 레이더 측정 데이터 
   * 파일이름 : 날짜_사람이름_거리_자세_특이사항.csv  
    
    ecg : 심전도(Target)
    bpm : 분당 심장박동수

    bin-2 : 사물위치 3.6x2 cm 앞에서 측정된 BPM
    bin-1 : 사물위치 3.6cm 앞
    bin0  : 감지된 사물위치
    bin1  : 사물위치 3.6cm 뒤
    bin2  : 사물위치 3.6x2 cm 뒤
    
    512fft : 512 frame window (512/20=25.6초 윈도우)의 FFT로 BPM
    400fft : 400  //
    300fft : 300  //
    200fft : 200  //
    100fft : 100  //
    70fft  : 70   //

    bin_var : 큰 움직임(3.6 cm)의 정도
    motion_energy : 작은 움직임(레이더 신호의 흔들림 크기)의 정도
    
## 2. 데이터 분석
   * 11명의 사람에 대한 데이터 EDA 및 시각화
   * 타겟값인 ecg와 bin, fft 특성간의 관계 시각화
   * 특성들의 이상치 파악 후 제거
   
## 3. 모델링
   * MinMaxScaler(base) 이상치에 민감
     → PowerTransformer : 데이터의 특성별로 정규분포형태에 가깝도록 변환
   * 기본모델(NN)에 대한 성능 개선
   * 개인별, 범용 데이터 모델링
   * 차원 축소를 위한 PCA 사용
   * 스태킹 앙상블 방법을 통한 성능 개선
   * 기존 스태킹 앙상블이 아닌 CV KFold 스태킹 앙상블 모델 사용  
     * 5가지 모델 비교(NN, SVR, RFR, XGB, LGBM)  
     * 5가지 중 성능이 안좋은 SVR을 제외한 나머지 4개의 모델을 사용  
   * hyperopt를 이용한 하이퍼파라미터 조정
   
## 4. 결과
   * 5가지 모델중 XGBoost 모델이 성능이 가장 좋음(에러율 0.451)
   * 범용 모델(NN)의 기존 에러율 약 12%에서 0.501%로 감소
   * **최종 범용 모델로 11명 개인 예측한 결과 모두 에러율 1% 미만으로 예측**
   
## 5. 개선하고 싶은 점
   * 오차율이 너무 좋게 나와서 과적합이 의심됨
   * 노이즈 데이터였던 bin_var과 motion_energy가 높은 특성중요도를 가짐
   * 400fft의 이상치 해석의 어려움
   * 타겟의 이상치를 측정하는 것이 중요하다는 점을 고려하는 것이 어려움
